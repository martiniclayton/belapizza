<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    <title>Cadastro - Bela Pizza</title>
</head>
<body>
    <main>
        <div class="conteiner-cadastro">
            <div class="cadastro">
                <h1>Realize o seu cadastro</h1>
                <form action="">

                    <div class="form-cadastro">
                        <div class="form-nome-cpf">
                            <input type="text" name="nome" id="nome" placeholder="Nome" class="input-medio">
                            <input type="text" name="cpf" id="cpf" placeholder="CPF" class="input-curto">
                        </div>
                        <div class="form-email-telefone">
                            <input type="text" name="email" id="email" placeholder="E-mail" class="input-medio">
                            <input type="text" name="telefone" id="telefone" placeholder="Telefone" class="input-curto">
                        </div>
                        <div class="form-endereco">
                            <input type="text" placeholder="Endereço" name="endereco" id="endereco" class="input-endereco">
                        </div>
                        <div class="form-endereco2">
                            <input type="text" placeholder="Cidade" name="cidade" id="cidade" class="input-endereco2">
                            <input type="text" placeholder="Estado" name="estado" id="estado" class="input-endereco2">
                            <input type="text" placeholder="CEP" name="cep" id="cep" class="input-endereco3">
                        </div>
                        <div class="form-senha">
                            <input type="password" placeholder="Senha" name="senha" id="senha" class="input-senha">
                            <input type="password" placeholder="Confirmar Senha" name="confirmarSenha" id="confirmar-senha" class="input-senha">
                        </div>
                        <div class="termos-check">
                            <input type="checkbox" name="" id="checkbox">
                            <div class="spanspan">
                                <span id="span">Eu concordo com os <span id="termos" style="color: blue;">Termos de Serviço</span> e reconheço a Política de Privacidade</span>
                            </div> 
                        </div>
                        <p id="erro"></p>
                        <dialog id="termos-dialog">
                            <div class="termosModal">
                                <h2>Termos de Serviço - Bela Pizza</h2>
                                <h3>Ultima Atualização: 01/05/2025</h3>
                                <span>Bem-vindo à Bela Pizza! Ao acessar e utilizar nosso site, você concorda com os seguintes termos. Leia com atenção antes de realizar seu cadastro ou fazer pedidos.</span>
                                <ol>
                                    <li>Cadastro de Usuário</li>
                                    <ul>
                                        <li>Para realizar pedidos, o usuário deve se cadastrar com informações válidas como nome, e-mail, telefone, endereço e senha.</li>
                                        <li>O usuário é responsável por manter seus dados atualizados e por proteger a confidencialidade da sua conta e senha.</li>
                                    </ul>
                                    <li>Realização de Pedidos</li>
                                    <ul>
                                        <li>Os pedidos realizados pelo site serão processados após a confirmação do pagamento.</li>
                                        <li>O tempo de entrega é uma estimativa e pode variar conforme a demanda e localização do usuário.</li>
                                        <li>Após a finalização do pedido, não é possível fazer alterações no pedido diretamente pelo site. Para isso, entre em contato com a nossa equipe imediatamente.</li>
                                    </ul>
                                </ol>
                                <ol>
                                    <li>Cancelamentos e Reembolsos</li>
                                    <ul>
                                        <li>O cancelamento de um pedido pode ser feito antes do início do preparo.</li>
                                        <li>Em caso de erro no pedido ou problema com a entrega, entre em contato com o suporte para avaliação e possível reembolso ou nova entrega.</li>
                                    </ul>
                                </ol>
                                <ol>
                                    <li>Privacidade</li>
                                    <ul>
                                        <li>Os dados fornecidos pelos usuários são armazenados com segurança e utilizados exclusivamente para fins operacionais (entrega, comunicação e promoções).</li>
                                        <li>Não compartilhamos suas informações com terceiros sem seu consentimento, exceto quando exigido por lei.</li>
                                    </ul>
                                </ol>
                                <ol>
                                    <li>Uso Indevido</li>
                                    <ul>
                                        <li>O uso do site para fins ilegais ou para prejudicar a operação da pizzaria é proibido.</li>
                                        <li>Contas que apresentarem comportamento suspeito, fraudulento ou abusivo poderão ser suspensas ou excluídas sem aviso prévio.</li>
                                    </ul>
                                </ol>
                                <ol>
                                    <li>Contas que apresentarem comportamento suspeito, fraudulento ou abusivo poderão ser suspensas ou excluídas sem aviso prévio.</li>
                                    <ul>
                                        <li>A Bela Pizza pode atualizar estes termos a qualquer momento. Ao continuar usando o site após mudanças, o usuário concorda com os novos termos.

                                        </li>
                                    </ul>
                                </ol>
                                <button id="aceitar-termos" type="button">Aceitar</button>
                                <button id="fechar-termos" type="button">Fechar</button>
                                <h3>Se tiver dúvidas, entre em contato conosco pelo e-mail: <h3 style="color: blue;">contato@belapizza.com.br</h3><h3> ou pelo WhatApp</h3>
                            </div>
                        </dialog>
                        <div class="botao-form">
                            <button id="cadastrar">Cadastrar</button>
                        </div>
                    </div>
                </form>
            </div>
            <div class="continuar-cadastro">
                <button><img src="img/google.png" alt="" width="20">Continuar com Google</button>
                <button><img src="img/apple.png" alt="" width="20">Continuar com Apple</button>
                <hr>
                <span id="jpc">Já possui uma conta? <span id="fla">Faça login aqui</span></span>
            </div>
        </div>
    </main>
    <script>
        const checkboxTermos = document.querySelector("#checkbox")
        const buttonCadastrar = document.querySelector("#cadastrar")

        buttonCadastrar.onclick = function (e) {
    e.preventDefault();

    const nome = document.querySelector("#nome");
    const cpf = document.querySelector("#cpf");
    const endereco = document.querySelector("#endereco");
    const email = document.querySelector("#email");
    const telefone = document.querySelector("#telefone");
    const senha = document.querySelector("#senha");
    const confirmarSenha = document.querySelector("#confirmar-senha");
    const erro = document.querySelector("#erro");
    const cidade = document.querySelector("#cidade");
    const estado = document.querySelector("#estado");
    const cep = document.querySelector("#cep");

    if (!checkboxTermos.checked) {
        alert("Você precisa aceitar os Termos de Uso e Privacidade");
        return;
    }

    if (!nome.value.trim() || !cpf.value.trim() || !endereco.value.trim() || !email.value.trim() || !telefone.value.trim() || !senha.value.trim() || !confirmarSenha.value.trim() || !cidade.value.trim() || !estado.value.trim() || !cep.value.trim()) {
        erro.textContent = "Preencha os campos necessários";
        return;
    }

    if (senha.value !== confirmarSenha.value) {
        erro.textContent = "As senhas não coincidem";
        return;
    }

    if (senha.value.length < 6) {
        erro.textContent = "A senha deve ter mais de 6 caracteres";
        return;
    }

    const userData = {
        nome: nome.value,
        email: email.value,
        cpf: cpf.value,
        telefone: telefone.value,
        nmEndereco: endereco.value,
        cep: cep.value,
        numero: 0,
        cidade: cidade.value,
        estado: estado.value,
        senha: senha.value,
        confirmarSenha: confirmarSenha.value
    };

    fetch("https://pizzaria-api-45n7.onrender.com/api/Cliente/CriarCadastroCliente", {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify(userData)
    })
    .then(response => {
        if (!response.ok) {
            throw new Error("Erro ao cadastrar usuário");
        }
        return response.json();
    })
    .then(data => {
        alert("Cadastro realizado com sucesso!");
        window.location.href = "index.html";
    })
    .catch(error => {
        console.error("Erro ao enviar dados:", error);
        erro.textContent = "Erro ao cadastrar. Verifique os dados e tente novamente.";
    });
};

        const termos = document.querySelector("#termos")
        const termosDialog = document.querySelector("#termos-dialog")

        termos.onclick = function(){
            termosDialog.showModal()
        }
        window.addEventListener("click", (e)=>{
            if(e.target===termosDialog){
                termosDialog.close()
            }
        })
        const buttonModalAceitar = document.querySelector("#aceitar-termos")

        buttonModalAceitar.addEventListener("click", (e)=>{
            checkboxTermos.checked = true
            termosDialog.close()
        })

        const buttonFecharModal = document.querySelector("#fechar-termos")
        buttonFecharModal.onclick = function(){
            termosDialog.close()
        }

        const jaPossuiConta = document.querySelector("#fla")

        jaPossuiConta.addEventListener("click", (e)=>{
            window.location.href =  "index.html?modal=abrir"
        })
    </script>
</body>
</html>